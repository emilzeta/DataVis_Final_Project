---
title: "DataVis Final Project"
author: "Emil Zetterquist"
date: "3/23/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
library(tidyverse)
library(here)
library(shiny)
library(plotly)

players_df <- read_csv("Data/skaters.csv")
```


```{r}
all_df <- players_df %>%
  filter(situation == "all") %>%
  mutate(minutes_icetime = icetime/60,
         ice_per_game = minutes_icetime/games_played)

top_10 <- all_df %>% 
  arrange(-ice_per_game) %>%
  slice(1:10) %>%
  mutate(name = fct_reorder(name, ice_per_game))






ggplot(data = top_10, aes(y = name, 
                            x = ice_per_game,
                            text = ice_per_game)) +
    geom_point(colour = "blue",
             size = 2.5) +
    labs(y = "",
         x = "Time on Ice per Game") +
  coord_cartesian(xlim = c(23, 28))
  
p1 <- ggplotly(tooltip = "text",
         displayModeBar = FALSE) 

```

```{r}
var_choice <- names(top_10)

library(shiny)

ui <- fluidPage(
  sidebarLayout(sidebarPanel(
    selectizeInput("statchoice",
                   label = "Choose a Statistic",
                   choices = var_choice,
                   selected = top_10$ice_per_game)
  ),
  mainPanel(
    plotlyOutput(outputId = "plot1")
  ))
)

server <- function(input, output, session) {
  
  top_10_react <- reactive({
    all_df %>% 
      arrange(-input$statchoice) %>%
      slice(1:10) %>%
      mutate(name = fct_reorder(name, input$statchoice))})
  
  ggplot(data = top_10_react(), aes(y = name, 
                            x = input$statchoice,
                            text = input$statchoice)) +
    geom_point(colour = "blue",
             size = 2.5) +
    labs(y = "") 
  
output$plot1 <- renderPlotly(
  ggplotly(tooltip = "text",
         displayModeBar = FALSE)
)
}

shinyApp(ui, server)
```

